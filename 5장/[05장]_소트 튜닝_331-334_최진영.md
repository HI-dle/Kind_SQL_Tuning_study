SQL ÏàòÌñâ ÎèÑÏ§ë Í∞ÄÍ≥µÎêú Îç∞Ïù¥ÌÑ∞ ÏßëÌï©Ïù¥ ÌïÑÏöîÌï† Îïå, Ïò§ÎùºÌÅ¥ÏùÄ `PGA`ÏôÄ `Temp ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§`Î•º ÌôúÏö©ÌïúÎã§.(ÏÜåÌä∏ Î®∏ÏßÄ Ï°∞Ïù∏, Ìï¥Ïãú Ï°∞Ïù∏, Îç∞Ïù¥ÌÑ∞ ÏÜåÌä∏, Í∑∏Î£πÌïë Îì±)

4Ïû•ÏóêÏÑú Í∞Å Ï°∞Ïù∏Îì§Ïóê ÎåÄÌï¥ `PGA`ÏôÄ `Temp ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§`Î•º Ïñ¥ÎñªÍ≤å ÌôúÏö©ÌïòÎäîÏßÄ ÏÇ¥Ìé¥Î¥§Îã§.

ÏßÄÍ∏àÎ∂ÄÌÑ∞Îäî Îç∞Ïù¥ÌÑ∞Î•º `ÏÜåÌä∏`ÌïòÍ±∞ÎÇò `Í∑∏Î£πÌïë`ÌïòÎäî Í≥ºÏ†ïÏùÑ ÏÇ¥Ìé¥Î≥¥Ïûê.

# 5.1 ÏÜåÌä∏ Ïó∞ÏÇ∞Ïóê ÎåÄÌïú Ïù¥Ìï¥

## 5.1.1 ÏÜåÌä∏ ÏàòÌñâ Í≥ºÏ†ï
- ÏÜåÌä∏Îäî `Í∏∞Î≥∏Ï†ÅÏúºÎ°ú` PGAÏóê Ìï†ÎãπÌïú `Sort Area`ÏóêÏÑú Ïù¥Î£®Ïñ¥ÏßÑÎã§.
- `Sort Area`Í∞Ä Îã§ Ï∞®Î©¥, `ÎîîÏä§ÌÅ¨ Temp ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§`Î•º ÌôúÏö©ÌïúÎã§.

---
### Îëê Í∞ÄÏßÄ Ïú†ÌòïÏùò ÏÜåÌä∏
**Sort AreaÏóêÏÑú ÏûëÏóÖÏùÑ ÏôÑÎ£åÌï† Ïàò ÏûàÎäî ÏßÄ**Ïóê Îî∞Îùº ÎÇòÎààÎã§.
- **Î©îÎ™®Î¶¨ ÏÜåÌä∏(`In-Memory Sort`)**: Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞Ïùò Ï†ïÎ†¨ ÏûëÏóÖÏùÑ Î©îÎ™®Î¶¨ ÎÇ¥ÏóêÏÑú ÏôÑÎ£åÌïòÎäî Í≤É(`= Internal Sort`)
- **ÎîîÏä§ÌÅ¨ ÏÜåÌä∏(`To-Disk Sort`)**: Ìï†ÎãπÎ∞õÏùÄ Sort Area ÎÇ¥ÏóêÏÑú Ï†ïÎ†¨ÏùÑ ÏôÑÎ£åÌïòÏßÄ Î™ªÌï¥ ÎîîÏä§ÌÅ¨ Í≥µÍ∞ÑÍπåÏßÄ ÏÇ¨Ïö©ÌïòÎäî Í≤ΩÏö∞Î•º ÎßêÌï®(`= External Sort`)

### ÎîîÏä§ÌÅ¨ ÏÜåÌä∏ Í≥ºÏ†ï
![Í∑∏Î¶º_5-1.png](image%2F%EA%B7%B8%EB%A6%BC_5-1.png)
1. ÏÜåÌä∏Ìï† ÎåÄÏÉÅ ÏßëÌï©ÏùÑ `SGA Î≤ÑÌçºÏ∫êÏãú`Î•º ÌÜµÌï¥ ÏùΩÎäîÎã§.
2. PGAÏùò `Sort Area`ÏóêÏÑú ÏùºÏ∞®Ï†ÅÏúºÎ°ú Ï†ïÎ†¨ÏùÑ ÏãúÎèÑÌïúÎã§.(Ïó¨Í∏∞ÏÑú ÎßàÎ¨¥Î¶¨ÌïòÎäî Í≤ÉÏù¥ ÏµúÏ†Å!)
3. ÏñëÏù¥ ÎßéÏùÑ ÎïåÎäî `Ï†ïÎ†¨Îêú Ï§ëÍ∞ÑÏßëÌï©`ÏùÑ `Temp ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§`Ïóê ÏûÑÏãú ÏÑ∏Í∑∏Î®ºÌä∏Î•º ÎßåÎì§Ïñ¥ Ï†ÄÏû•ÌïúÎã§.(Ïù¥ Îïå, Sort AreaÍ∞Ä Ï∞∞ ÎïåÎßàÎã§ Temp ÏòÅÏó≠Ïóê Ï†ÄÏû•ÌïòÎäî Ï§ëÍ∞ÑÏßëÌï©ÏùÑ `Sort Run`Ïù¥ÎùºÍ≥† ÌïúÎã§.)
4. ÏµúÏ¢Ö Í≤∞Í≥ºÏßëÌï©ÏùÑ ÏñªÏúºÎ†§Î©¥ Ï§ëÍ∞ÑÏßëÌï©Îì§ÏùÑ `merge`Ìï¥ÏïºÌïúÎã§.

> ÎßåÏïΩ Ïò§Î¶ÑÏ∞®Ïàú Ï†ïÎ†¨Ïù¥ÎùºÎ©¥, Í∞Å `Sort Run`ÏóêÏÑú Í∞ÄÏû• ÏûëÏùÄ Í∞íÏùÑ ÏùΩÏñ¥ÏÑú PGAÎ°ú ÏùΩÏñ¥ Îì§Ïù¥Îã§Í∞Ä PGAÍ∞Ä Ï∞∞ ÎïåÎßàÎã§ ÏøºÎ¶¨ ÏàòÌñâ Îã§Ïùå Îã®Í≥ÑÎ°ú Ï†ÑÎã¨ÌïòÍ±∞ÎÇò ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ÏóêÍ≤å Ï†ÑÏÜ°ÌïòÎ©¥ ÎêúÎã§.

![Í∑∏Î¶º_5-1_Î≥¥Í∞ï.png](image%2F%EA%B7%B8%EB%A6%BC_5-1_%EB%B3%B4%EA%B0%95.png)
---

## Ïù¥Ïóê Îî∞Î•∏ ÏÜåÌä∏ Ïó∞ÏÇ∞Ïùò ÌäπÏßï
### 1. ÏÜåÌä∏ Ïó∞ÏÇ∞ÏùÄ `Î©îÎ™®Î¶¨ ÏßëÏïΩÏ†Å(intensive)`Ïùº ÎøêÎßå ÏïÑÎãàÎùº `CPU ÏßëÏïΩÏ†Å`Ïù¥Í∏∞ÎèÑ ÌïòÎã§.
Î©îÎ™®Î¶¨ÏôÄ CPUÎ•º ÎßéÏù¥ ÏÇ¨Ïö©ÌïòÎäî ÏûëÏóÖÏù¥ÎùºÎäî Í≤ÉÏùÑ ÏùòÎØ∏ÌïúÎã§. 
- Ï†ïÎ†¨ÌïòÍ∏∞ ÏúÑÌï¥ `Sort Area(Î©îÎ™®Î¶¨)`Ïóê Îç∞Ïù¥ÌÑ∞Î•º Ïò¨Î†§ÏïºÌïòÎØÄÎ°ú
- Ï†ïÎ†¨ÌïòÍ∏∞ ÏúÑÌï¥ CPUÎ°ú ÎπÑÍµê Ïó∞ÏÇ∞ÏùÑ Ìï¥ÏïºÌïòÎØÄÎ°ú

### 2. Ï≤òÎ¶¨Ìï† Îç∞Ïù¥ÌÑ∞ÎüâÏù¥ ÎßéÏùÑ ÎïåÎäî ÎîîÏä§ÌÅ¨ I/OÍπåÏßÄ Î∞úÏÉùÌïòÎØÄÎ°ú ÏøºÎ¶¨ ÏÑ±Îä•ÏùÑ Ï¢åÏö∞ÌïòÎäî Ï§ëÏöîÌïú ÏöîÏÜåÏù¥Îã§.
ÏúÑ ÎÇ¥Ïö©ÏóêÏÑú, Ï≤òÎ¶¨Ìï† Îç∞Ïù¥ÌÑ∞ÎüâÏù¥ ÎßéÏúºÎ©¥ `Sort Area` ÎøêÎßå ÏïÑÎãå `Temp ÌÖåÏù¥Î∏îÏä§ÌéòÏù¥Ïä§(ÎîîÏä§ÌÅ¨)`Ïóê Ï†ëÍ∑ºÌïòÎäî Í≤ÉÏùÑ Ïïå Ïàò ÏûàÎã§.

### 3. Î∂ÄÎ∂ÑÎ≤îÏúÑ Ï≤òÎ¶¨Î•º Î∂àÍ∞ÄÎä•ÌïòÍ≤å ÌïòÍ∏∞ ÎïåÎ¨∏Ïóê OLTP ÌôòÍ≤ΩÏóêÏÑú ÏÑ±Îä•ÏùÑ Ï†ÄÌïòÏãúÌÇ®Îã§.
Ï†ïÎ†¨ÏùÄ Ï†ÑÏ≤¥ ÏàúÏÑúÎ•º ÏïåÏïÑÎÇ¥ÏïºÌïòÎäî Í≤ÉÏù¥ÎØÄÎ°ú, ÏùºÎ∂ÄÎßå Î®ºÏ†Ä ÏùëÎãµÌï† Ïàò ÏóÜÎã§Îäî Í≤ÉÏùÑ ÏùòÎØ∏ÌïúÎã§.

> Îî∞ÎùºÏÑú, Îê† Ïàò ÏûàÏúºÎ©¥ ÏÜåÌä∏Í∞Ä Î∞úÏÉùÌïòÏßÄ ÏïäÎèÑÎ°ù SQLÏùÑ ÏûëÏÑ±Ìï¥ÏïºÌïòÍ≥†, ÏÜåÌä∏Í∞Ä Î∂àÍ∞ÄÌîºÌïòÎã§Î©¥ Î©îÎ™®Î¶¨ ÎÇ¥ÏóêÏÑú ÏôÑÎ£åÌï† Ïàò ÏûàÎèÑÎ°ù Ìï¥Ïïº ÌïúÎã§!

---
## 5.1.2 ÏÜåÌä∏ Ïò§ÌçºÎ†àÏù¥ÏÖò
ÏÜåÌä∏ ÌäúÎãùÏùÑ ÏÑ§Î™ÖÌïòÍ∏∞Ïóê ÏïûÏÑú `ÏÜåÌä∏Î•º Î∞úÏÉùÏãúÌÇ§Îäî Ïò§ÌçºÎ†àÏù¥ÏÖòÏóê Ïñ¥Îñ§ Í≤ÉÎì§Ïù¥ ÏûàÎäîÏßÄ` ÏÇ¥Ìé¥Î≥¥Ïûê.
- Sort Aggregate
- Sort Order By
- Sort Group By
- Sort Unique
- Sort Join
- Window Sort

### 1. Sort Aggregate
`Sort Aggregate`Îäî Ï†ÑÏ≤¥ Î°úÏö∞Î•º ÎåÄÏÉÅÏúºÎ°ú ÏßëÍ≥ÑÎ•º ÏàòÌñâÌï† Îïå ÎÇòÌÉÄÎÇúÎã§.

ÏïÑÎûò ÏòàÏãúÏùò Ïã§ÌñâÍ≥ÑÌöçÏùÑ Î≥¥Î©¥ `Sort Aggregate`Í∞Ä Î≥¥Ïù∏Îã§. `Sort`ÎùºÎäî ÌëúÌòÑÏùÑ ÏÇ¨Ïö©ÌïòÏßÄÎßå, Ïã§Ï†úÎ°ú Îç∞Ïù¥ÌÑ∞Î•º Ï†ïÎ†¨ÌïòÏßÑ ÏïäÍ≥†, **`Sort Area`Î•º ÏÇ¨Ïö©ÌïúÎã§Îäî ÏùòÎØ∏**Î°ú Ïù¥Ìï¥ÌïòÎ©¥ ÎêúÎã§.

```shell
SQL> select sum(sal), max(sal), min(sal), avg(sal) from emp;
= EMP ÌÖåÏù¥Î∏î Ï†ÑÏ≤¥Ïùò Í∏âÏó¨(sal)Î•º ÏßëÍ≥ÑÌïòÎäî ÏøºÎ¶¨

---------------------------------------------------------------------------
| Id | Operation           | Name | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------
|  0 | SELECT STATEMENT    |      |     1 |     4 |      3  (0)| 00:00:01 |
|  1 |  SORT AGGREGATE     |      |     1 |     4 |            |          |
|  2 |   TABLE ACCESS FULL | EMP  |    14 |    56 |      3  (0)| 00:00:01 |
---------------------------------------------------------------------------
```

> **üí° SUM, MAX, MIN, AVG Í∞íÏùÑ Íµ¨ÌïòÎäî Ï†àÏ∞®**
> 
> 1. `Sort Area`Ïóê `sum, max, min, count`ÏùÑ ÏúÑÌïú Î≥ÄÏàòÎ•º Ìï†ÎãπÌïúÎã§.
> 
> 
> 2. EMP ÌÖåÏù¥Î∏îÏùò Ï≤´ Î≤àÏß∏ Î†àÏΩîÎìúÏóêÏÑú ÏùΩÏùÄ Í∞íÏùÑ Í∞Å Î≥ÄÏàòÏóê Ï†ÄÏû•ÌïúÎã§.
> ![Í∑∏Î¶º_5-2.png](image%2F%EA%B7%B8%EB%A6%BC_5-2.png)
> 
> 
> 3. Î†àÏΩîÎìúÎ•º ÎßàÏ†Ä ÏùΩÏñ¥Í∞ÄÎ©¥ÏÑú `sum` Î≥ÄÏàòÏóêÎäî ÎàÑÏ†Å, `max/min`ÏùÄ ÏóÖÎç∞Ïù¥Ìä∏, `count`Îäî 1Ïî© Ï¶ùÍ∞ÄÏãúÌÇ®Îã§.
> ![Í∑∏Î¶º_5-3.png](image%2F%EA%B7%B8%EB%A6%BC_5-3.png)
> 
> 
> 4. Î†àÏΩîÎìúÎ•º Îã§ ÏùΩÏúºÎ©¥, AVGÎäî `sum / count`Î°ú Ï∂úÎ†•ÌïòÍ≥†, ÎÇòÎ®∏ÏßÄÎäî Í∑∏ÎåÄÎ°ú Ï∂úÎ†•ÌïòÎ©¥ ÎêúÎã§.

### 2. Sort Order By
`Sort Order By`Îäî Îç∞Ïù¥ÌÑ∞Î•º Ï†ïÎ†¨Ìï† Îïå ÎÇòÌÉÄÎÇúÎã§.(Ï†ïÎ†¨ Í≥ºÏ†ïÏùÄ ÏïûÏóêÏÑú ÌñàÎã§.)

```shell
SQL> select * from emp order by sal desc;
= EMP ÌÖåÏù¥Î∏îÏùÑ Í∏âÏó¨ Í∏∞Ï§ÄÏúºÎ°ú ÎÇ¥Î¶ºÏ∞®Ïàú Ï†ïÎ†¨

---------------------------------------------------------------------------
| Id | Operation           | Name | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------
|  0 | SELECT STATEMENT    |      |    14 |   518 |     4  (25)| 00:00:01 |
|  1 |  SORT ORDER BY      |      |    14 |   518 |     4  (25)| 00:00:01 |
|  2 |   TABLE ACCESS FULL | EMP  |    14 |   518 |     3   (0)| 00:00:01 |
---------------------------------------------------------------------------
```