# SQL 분석 도구

## 1. 실행계획 확인

**PLAN_TABLE 생성**

실행계획을 확인하려면 우선 plan_table을 생성해야 한다

```sql
-- ?는 $ORACLE_HOME 디렉토리
 @?/rdbms/admin/utlxplan.sql
```

10g 버전부터는 기본적으로 오라클이 sys.plan_table$ 테이블을 만들고, PLAN_TABLE로 명명한 public synonym도 생성하므로 사용자가 별도로 plan_table을 만들 필요가 없다

**SQL*PLUS에서 실행계획 확인**

plan_table을 생성했으면 실행계획을 생성할 차례이다 SQL Plus에서 아래와 같이 explain plan 명령어를 수행하면 된다. 그러면 실행계획이 plan_table에 저장된다.

```sql
 explain plan for
 select * from emp where empno = 7900;
```

plan_table에 저장된 실행계획을 확인하려면, 아래와 같이 오라클이 제공하는 utlxpls.sql스크립트를 이용하면된다

```sql
SET LINESIZE 200
@?/rdbms/admin/utlxpls

PLAN_TABLE_OUTPUT
---------------------------------------------------------------------------
Plan hash value: 4024650034


---------------------------------------------------------------------------
| Id | Operation           | Name | Rows  | Bytes | Cost (%CPU)| Time     |
---------------------------------------------------------------------------
|  0 | SELECT STATEMENT    |      |    14 |   518 |     4  (25)| 00:00:01 |
|  1 |  SORT ORDER BY      |      |    14 |   518 |     4  (25)| 00:00:01 |
|  2 |   TABLE ACCESS FULL | EMP  |    14 |   518 |     3   (0)| 00:00:01 |
---------------------------------------------------------------------------

Predicate Information (identified by operation id):
-----------------------------------------------------
2 - access("EMPNO"=7900)
```

위 실행계획은 예상 실행계획이다. 대개 이대로 실행하지만 다른 방식으로 실행하는 경우도 있다(이 방법은 뒤에서 소개)

**상용 쿼리 툴에서 실행계획 확인**

토드, 오렌지같은 상용쿼리 툴에서는 `Ctrl+E` <br>
SQLGate는 `F7`키를 누르면 하단에 실행계획이 출력된다.

**더 많은 정보 확인하기**

상용 쿼리툴이 제공하는 기능을 이용하면 편리하지만 더 많은 정보를 확인하기 위해선 SQL Plus의 explain plan 명령어가 필요하다

explain plan 실행 후 아래 쿼리를 수행해보면 어떤 정보가 더 수집돼 있는지 확인 할 수 있다.
```sql
    select * from table(dbms_xplan.display(null,null,'advanced'));
```


